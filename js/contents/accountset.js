"use strict";

////////////////////////////////////////////////////////////////////////////////
// アカウント設定
////////////////////////////////////////////////////////////////////////////////
Contents.accountset = function( cp )
{
	var p = $( '#' + cp.id );
	var cont = p.find( 'div.contents' );

	cp.SetIcon( 'icon-cog' );

	////////////////////////////////////////////////////////////
	// 初期入力値設定
	////////////////////////////////////////////////////////////
	var MakeInput = function() {
		cont.html( '' )
			.addClass( 'accountset' );

		var account = g_cmn.account[cp.param.account_id];
		cp.SetTitle( i18nGetMessage( 'i18n_0047' ) + ' (' + account.display_name + '@' + account.instance + ')', false );

		cont.html( OutputTPL( 'accountset', {} ) );
	};

	////////////////////////////////////////////////////////////
	// 開始処理
	////////////////////////////////////////////////////////////
	this.start = function() {
		////////////////////////////////////////
		// このパネルを開いたアカウントが
		// 削除された場合
		////////////////////////////////////////
		var AccountAliveCheck = function() {
			if ( g_cmn.account[cp.param['account_id']] == undefined )
			{
				// パネルを閉じる
				p.find( '.close' ).trigger( 'click', [false] );
				return false;
			}

			return true;
		};

		////////////////////////////////////////
		// アカウント情報更新
		////////////////////////////////////////
		cont.on( 'account_update', function() {
			AccountAliveCheck();
		} );

		////////////////////////////////////////
		// アカウント変更
		////////////////////////////////////////
		cont.on( 'account_change', function() {
			MakeInput();
		} );

		// 全体を作成
		MakeInput();
	};

	////////////////////////////////////////////////////////////
	// 終了処理
	////////////////////////////////////////////////////////////
	this.stop = function() {
	};
}
